pipeline {
    agent {
        kubernetes {
            label 'maven'
            cloud 'openshift'
            defaultContainer 'jnlp'
            serviceAccount 'jenkins'
            yaml """
              kind: Pod
              metadata:
                name: jenkins-slave
              spec:
                containers:
                - name: jnlp
                  image: registry.access.redhat.com/openshift3/jenkins-agent-maven-35-rhel7
                  privileged: false
                  alwaysPullImage: false
                  workingDir: /tmp
                  ttyEnabled: false
                  volumeMounts:
                  - mountPath: '/home/jenkins/.m2'
                    name: pvc
                volumes:
                - name: pvc
                  persistentVolumeClaim:
                    claimName: 'maven-slave-pvc'
            """
        }
    }

    environment {
        APP_NAME = 'student-exam-api'
    }

    parameters([
        choice(
            choices: ['ONE', 'TWO'],
            name: 'PARAMETER_01'
        ),
        booleanParam(
            defaultValue: true,
            description: '',
            name: 'BOOLEAN'
        ),
        text(
            defaultValue: '''
            this is a multi-line
            string parameter example
            ''',
             name: 'MULTI-LINE-STRING'
        ),
        string(
            defaultValue: 'scriptcrunch',
            name: 'STRING-PARAMETER',
            trim: true
        )
    ])

    stages {
        stage('Init') {
            steps {
                script {
                    println 'Initialization Complete!'
                }
            }
        }
        post {
            success {
                echo 'Pipeline Successful'
            }
            failure {
                echo 'Pipeline Failed'
            }
            always {
                echo 'Pipeline END'
            }
        }
    }
}
