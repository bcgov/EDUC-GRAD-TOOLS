pipeline {
    agent {
        kubernetes {
            label 'maven'
            cloud 'openshift'
            defaultContainer 'jnlp'
            serviceAccount 'jenkins'
            yaml """
              kind: Pod
              metadata:
                name: jenkins-slave
              spec:
                containers:
                - name: jnlp
                  image: registry.access.redhat.com/openshift3/jenkins-agent-maven-35-rhel7
                  privileged: false
                  alwaysPullImage: false
                  workingDir: /tmp
                  ttyEnabled: false
                  volumeMounts:
                  - mountPath: '/home/jenkins/.m2'
                    name: pvc
                volumes:
                - name: pvc
                  persistentVolumeClaim:
                    claimName: 'maven-slave-pvc'
            """
        }
    }

    environment {
        APP_NAME = 'student-exam-api'
    }

    parameters {
        choice(name: 'Choice Param', choices: ['False', 'True'], description: 'Select 1 option')
        extendedChoice(name: 'Extended Choice Param', value: ['Choice1', 'Choice2', 'Choice3'], defaultValue: 'Choice2', description: 'Choose 1 or more', multiSelectDelimiter: ',', type: 'PT_MULTI_SELECT', visibleItemCount: 5) //PubSize())
        gitParameter branchFilter: 'origin/(.*)', defaultValue: '', name: 'CODE_BRANCH', type: 'PT_BRANCH', description: 'Code Branch', listSize: '10', useRepository: '.*EDUC-GRAD-TOOLS', quickFilterEnabled: true
    }

    stages {
        stage('Init') {
            steps {
                script {
                    println 'Initialization Complete!'
                }
            }
        }
        post {
            success {
                echo 'Pipeline Successful'
            }
            failure {
                echo 'Pipeline Failed'
            }
            always {
                echo 'Pipeline END'
            }
        }
    }
}
